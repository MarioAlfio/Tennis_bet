# etl/extract.py

import pandas as pd
from logger import setup_logger
import os

logger = setup_logger()

def load_csv(file_path):
    """
    Carica un singolo file CSV in un DataFrame. 
    Controlla l'esistenza del file e logga eventuali errori.
    """
    if not os.path.exists(file_path):
        logger.error(f"File non trovato: {file_path}")
        raise FileNotFoundError(f"{file_path} non esiste")

    try:
        df = pd.read_csv(file_path)
        logger.info(f"File caricato: {file_path} ({len(df)} righe)")
        return df
    except Exception as e:
        logger.error(f"Errore nel caricamento di {file_path}: {e}")
        raise
